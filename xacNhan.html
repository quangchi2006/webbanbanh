<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xác Nhận Đơn Hàng - Tiệm Bánh Ngọt Ngào</title>
    <link rel="stylesheet" href="css/bootstrap-5.3.3-dist/bootstrap-5.3.3-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        xintegrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" /> 
    <link rel="icon" href="./img/iconLogo2.png" type="image/x-icon">

    <style> 
        @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap');
        body {
            width: 100%;
            background-image: url(./img/bg2.jpg);  
            display: flex;
            justify-content: center;
            align-items: center;
            background-size: cover;
            overflow-y: scroll;
            min-height: 100vh; 
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        .container_comfirm {
            margin-top: 50px;
            margin-bottom: 50px; 
            display: flex;
            padding: 0 !important;
            border-radius: 16px;
            overflow: hidden;
            background-color: #fff; 
            max-width: 1100px; 
            width: 90%; 
        }
        select,
        input[type="text"], input[type="email"], input[type="tel"] {
            display: block;
            width: 100%;
            border: none;
            border-bottom: 1px solid #bfbfbf;
            line-height: 30px;
            padding: 0 5px;
            margin-bottom: 16px; 
        }
        input::placeholder {
            color: #676767;
        }
        select  {
            color: #676767;
        }

        select {
            border:none !important;
            height: 30px;
            padding: 0!important;
            margin-bottom: 16px;
            border-bottom: 1px solid #bfbfbf !important;
        }
        input:focus-visible{
            border-bottom: 1px solid #bfbfbf;
            outline: none;
        }
        .item {
            margin-bottom: 20px;
        }
        .content-form { 
            width: 100%;
            padding: 32px;
        }
        .order-summary { 
            width: 100%;
            padding: 32px;
            background-color: #ab0e0e; 
            color: #fff; 
        }

        .list__food { 
            padding: 0;
            margin: 0;
            list-style: none;
        }
        .shopping__list li { 
            margin-bottom:16px; 
            display: flex; 
            justify-content: space-between;
            align-items: center; 
        }
        .shopping__item__img {
            width: 80px; 
            height: 60px; 
            border-radius:6px;
            object-fit: cover; 
        }
        .shopping__item__content {
            flex-grow: 1; 
            padding: 0 12px;
        }
        .shopping__item__name h3 {
            font-size: 15px; 
            margin: 0 0 5px 0; 
            color: #fff;
            line-height: 1.2;
        }
        .shopping__item__input {
            width: 50px; 
            height: 28px;
            border: none; 
            background-color: rgba(255,255,255,0.1); 
            color: #fff;
            text-align: center;
            border-radius: 4px; 
        }
        .shopping__item__price {
            color: #fff;
            font-size: 14px; 
        }


        button.btn-confirm-order { 
            border: none;
            background-color:#F04506; 
            color: #fff;
            padding: 16px 20px ;
            border-radius:4px ;
            width: 100%; 
            transition: all 0.2s;
        }
        button.btn-confirm-order:hover {
            transform: scale(1.02);
            background-color: #d03c05; 
        }


        .delete { 
            display: none !important; 
        }


        .modal__thanks {
            position: fixed;
            width: 100%;
            height: 100vh;
            top: 0;left: 0;right: 0;bottom: 0;
            background-color: rgba(0, 0, 0, 0.6); 
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1050; 
            display: none; 
        }
        .container__thanks{
            max-height: 90vh; 
            width: 80%;
            max-width: 700px; 
            background-color: #fff;
            padding: 32px;
            border-radius:12px ;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3); 
            animation: showtop 0.5s ease-in-out forwards; 
            position: relative;
            overflow-y: auto; 
        }

        .showtotop { 
            opacity: 0;
            transform: translateY(-50px); 
        }


        @keyframes showtop {
            from{
                opacity: 0;
                transform: translateY(-50px);
            }to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .close_modal_btn i { 
            position: absolute;
            color: #555; 
            font-size: 24px; 
            top: 15px; 
            right: 15px;
        }
        .close_modal_btn:hover i {
            cursor: pointer;
            color: #F04506; 
        }

        .order-summary .shopping__list { 
            padding: 0;
            margin: 0;
            max-height: 300px;
            overflow-y:auto; 
            overflow-x:hidden;
            scroll-behavior: smooth; 
        }
        
        .total-display { 
            color: #fff; 
            font-size: 20px;
        }
        .total-display .total { 
            font-weight: bold;
        }


        .comfim_item { 
             height: 100%; 
        }
        
        @media (max-width: 767.98px) { 
            .container_comfirm {
                flex-direction: column; 
                margin-top: 20px;
                margin-bottom: 20px;
                width: 95%;
            }
            .container_comfirm .content-form, .container_comfirm .order-summary {
                padding: 20px; 
            }
            
            .shopping__item__content {
                width: auto !important; 
                flex-grow: 1;
            }
            .container__thanks {
                width: 90%;
                padding: 20px;
            }
            .modal__thanks p {
                font-size: 22px; 
            }
            .close_modal_btn i {
                top: 10px;
                right: 10px;
            }
            .order-summary h2 {
                font-size: 1.5rem; 
            }
        }
    </style>
</head>

<body>
    
<div class="container_comfirm">
    <div class="row g-0 w-100"> 
        
        <div class="col-md-6 col-sm-12">
            <div class="comfim_item">
                <div class="content-form" style="height: 100%;">
                    <h2 class="mb-4">Điền thông tin giao hàng</h2>
                    <form action="#" id="checkoutForm"> 
                        <div class="item">
                            <input type="text" placeholder="Họ và Tên" id="name" required>
                        </div>
            
                        <div class="item">
                            <input type="tel" placeholder="Điện thoại" id="sdt" required> 
                        </div>
            
                        <div class="item">
                            <input type="email" placeholder="Email" id="email" required>
                        </div>
            
                        <div class="item">
                            <select id="city" class="form-select mb-2" aria-label="Chọn tỉnh thành" required>
                                <option value="" selected>Chọn tỉnh thành</option>
                            </select>
                            <select id="district" class="form-select mb-2" aria-label="Chọn quận huyện" required>
                                <option value="" selected>Chọn quận huyện</option>
                            </select>
                            <select id="ward" class="form-select" aria-label="Chọn phường xã" required>
                                <option value="" selected>Chọn phường xã</option>
                            </select>
                        </div>  
                        <div class="item">
                            <input type="text" placeholder="Địa chỉ chi tiết (số nhà, tên đường)" id="address_detail" required>
                        </div>
                   
                        <div class="item">
                            <select name="payment_method" id="payment_method" class="form-select" required>
                                <option value="">Phương thức thanh toán</option>
                                <option value="momo">Thanh toán qua MOMO</option>
                                <option value="zalopay">Thanh toán qua ZaloPay</option>
                                <option value="bank">Thanh toán khi nhận hàng (COD)</option>
                                <option value="card">Thanh toán qua Ngân Hàng (Chuyển khoản)</option>
                            </select>
                        </div>
                        <div class="item form-check"> 
                            <input type="checkbox" class="form-check-input" id="check" required>
                            <label class="form-check-label" for="check" style="color:#676767;"> Tôi đồng ý với các điều khoản và điều kiện</label>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-sm-12">
            <div class="comfim_item">
                <div class="order-summary" style="height: 100%;">
                    <h2 style="color: #fff;" class="mb-4">Danh sách đặt hàng</h2>
                    <ul class="shopping__list">
                        <li> 
                            <img class="shopping__item__img" src="./img/cake1.webp" alt="Bánh Tiramisu">
                            <div class="shopping__item__content">
                                <span class="shopping__item__name"><h3>Bánh Tiramisu</h3></span>
                                <div style="display: flex; justify-content: space-between; align-items:center;">
                                    <input class="shopping__item__input" type="number" value="1" min="1" readonly> 
                                    <span class="shopping__item__price">35.000 VND</span>
                                </div>
                            </div>
                        </li>
                        <li> 
                            <img class="shopping__item__img" src="./img/cake2.webp" alt="Bánh Cheesecake">
                            <div class="shopping__item__content">
                                <span class="shopping__item__name"><h3>Bánh Cheesecake</h3></span>
                                <div style="display: flex; justify-content: space-between; align-items:center;">
                                    <input class="shopping__item__input" type="number" value="1" min="1" readonly>
                                    <span class="shopping__item__price">290.000 VND</span>
                                </div>
                            </div>
                        </li>
                    </ul>
            
                    <div class="mt-3 total-display">
                        <span>Tổng cộng: <span class="total">0 <span>VND</span></span></span>
                    </div>
            
                    <div class="mt-4 text-center"> 
                        <button type="submit" form="checkoutForm" class="btn-confirm-order">Xác nhận đơn hàng</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal__thanks">
    <div class="container__thanks">
        <a href="./index.html" class="close_modal_btn"> 
            <i class="fa-solid fa-xmark"></i>
        </a>
        <div style="margin-bottom: 24px; font-family: 'Great Vibes', cursive; font-size: 70px; color: #F04506; text-align: center;">Tiệm Bánh Đám Mây</div>
        
        <p style="font-family: 'Great Vibes', cursive; font-size: 24px; text-align:center;">
            Kính gửi Quý khách hàng: <strong id="customerNameThanks"></strong>
        </p>
        <p style="font-size: 16px; line-height: 1.6; color: #333; text-align: justify; margin-bottom: 20px;">
            Chúng tôi xin chân thành gửi lời cảm ơn sâu sắc đến Quý khách vì đã chọn lựa và đặt hàng tại Tiệm Bánh Đám Mây.
            Sự ủng hộ của Quý khách là niềm vinh hạnh và động lực to lớn để chúng tôi không ngừng nỗ lực mang đến những chiếc bánh thơm ngon cùng trải nghiệm dịch vụ tốt nhất.
            Đơn hàng của Quý khách đang được xử lý và sẽ sớm được giao đến.
            Một lần nữa, xin chân thành cảm ơn Quý khách. Chúc Quý khách một ngày tốt lành và thưởng thức bánh ngon miệng!
        </p>
        <p style="font-family: 'Great Vibes', cursive; font-size: 22px; text-align:right; margin-right: 50px; margin-top: 30px;">Trân trọng,</p>
        <p style="font-family: 'Great Vibes', cursive; font-size: 26px; text-align:right; margin-right: 50px;">Tiệm Bánh Đám MâyMây</p>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
<script>
    const citis = document.getElementById("city");
    const districts = document.getElementById("district");
    const wards = document.getElementById("ward");
    const checkoutForm = document.getElementById("checkoutForm");
    const customerNameInput = document.getElementById("name");
    const customerNameThanks = document.getElementById("customerNameThanks");


    axios.get("https://raw.githubusercontent.com/kenzouno1/DiaGioiHanhChinhVN/master/data.json")
        .then(function(response) {
            renderCity(response.data);
        })
        .catch(function(error) {
            console.error("Lỗi khi tải dữ liệu địa chỉ:", error);
        });

    function renderCity(data) {
        for (const city of data) {
            citis.options[citis.options.length] = new Option(city.Name, city.Id);
        }
        citis.onchange = function() {
            districts.length = 1; 
            wards.length = 1; 
            if (this.value !== "") {
                const result = data.find(n => n.Id === this.value);
                if (result) {
                    for (const district of result.Districts) {
                        districts.options[districts.options.length] = new Option(district.Name, district.Id);
                    }
                }
            }
        };
        districts.onchange = function() {
            wards.length = 1; 
            if (this.value !== "" && citis.value !== "") {
                const dataCity = data.find(n => n.Id === citis.value);
                if (dataCity) {
                    const dataDistrict = dataCity.Districts.find(n => n.Id === this.value);
                    if (dataDistrict) {
                        for (const ward of dataDistrict.Wards) {
                            wards.options[wards.options.length] = new Option(ward.Name, ward.Id);
                        }
                    }
                }
            }
        };
    }

    const containerThanks = document.querySelector('.container__thanks');
    const modalThanks = document.querySelector('.modal__thanks');
    
    if(checkoutForm) {
        checkoutForm.addEventListener('submit', (event) => {
            event.preventDefault(); 
            
            const confirmCheckbox = document.getElementById('check');
            if (!confirmCheckbox.checked) {
                alert('Vui lòng xác nhận đồng ý với các điều khoản và điều kiện.');
                return; 
            }

            if (customerNameInput && customerNameThanks) {
                customerNameThanks.textContent = customerNameInput.value || "Quý khách"; 
            }

            if (modalThanks && containerThanks) {
                modalThanks.style.display = 'flex'; 
                containerThanks.classList.add('showtotop'); 
                localStorage.removeItem('shopping_cart_items');
                localStorage.removeItem('shopping_cart_total');
                localStorage.removeItem('shopping_cart_quantity');
                console.log("Đơn hàng đã được xác nhận (dữ liệu form chưa được gửi đi đâu cả).");
            }
        });
    }
    
    const closeModalBtn = document.querySelector('.close_modal_btn');
    if (closeModalBtn && modalThanks) {
        closeModalBtn.addEventListener('click', (e) => {
            e.preventDefault(); 
            modalThanks.style.display = 'none';
            window.location.href = closeModalBtn.href; 
        });
    }
    
    function loadCartDataForConfirmation() {
        const savedItemsHTML = localStorage.getItem('shopping_cart_items');
        const savedTotalHTML = localStorage.getItem('shopping_cart_total');
        const shoppingListOnConfirmPage = document.querySelector('.order-summary .shopping__list');
        const totalOnConfirmPage = document.querySelector('.order-summary .total');

        if (savedItemsHTML && shoppingListOnConfirmPage) {
            shoppingListOnConfirmPage.innerHTML = savedItemsHTML;
            const inputs = shoppingListOnConfirmPage.querySelectorAll('.shopping__item__input');
            inputs.forEach(input => {
                input.setAttribute('readonly', true);
            });
            const deleteButtons = shoppingListOnConfirmPage.querySelectorAll('.delete');
            deleteButtons.forEach(button => button.style.display = 'none'); 
        } else if (shoppingListOnConfirmPage) {
            shoppingListOnConfirmPage.innerHTML = "<li>Không có sản phẩm nào trong đơn hàng.</li>";
        }

        if (savedTotalHTML && totalOnConfirmPage) {
            totalOnConfirmPage.innerHTML = savedTotalHTML;
        } else if (totalOnConfirmPage) {
            totalOnConfirmPage.innerHTML = "0 <span>VND</span>";
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        loadCartDataForConfirmation();
    });
    
</script>   
</body>
</html>
